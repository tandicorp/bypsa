<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="sale_order_form" model="ir.ui.view">
        <field name="name">sale.order.form</field>
        <field name="model">sale.order</field>
        <field name="priority">10</field>
        <field name="arch" type="xml">
            <form string="Movimiento">
                <header>
                    <field name="status_movement" clickable="1" widget="statusbar"
                           statusbar_visible="draft,insurance_release,approved,rejected,cancel"/>
                    <button class="oe_highlight oe_stat_button" type="object" string="Enviar orden de emisión"
                            attrs="{'invisible': [('status_movement','!=', 'draft')]}"
                            name="action_insurance_release"/>
                    <button class="oe_highlight oe_stat_button" type="object" string="Remitir movimiento"
                            attrs="{'invisible': [('status_movement','!=', 'draft')]}"
                            name="action_release_move"/>
                    <button class="oe_highlight oe_stat_button" type="object" string="Regresar a remitido"
                            attrs="{'invisible': [('status_movement','not in',('approved','rejected'))]}"
                            groups="broker_do.group_supervisor_contract" name="action_back_release_move"/>
                    <button class="oe_highlight oe_stat_button" type="object" string="Confirmar movimiento"
                            attrs="{'invisible': [('status_movement','!=', 'insurance_release')]}"
                            name="action_approve_move"/>
                    <button class="oe_highlight oe_stat_button" type="object" string="Rechazar movimiento"
                            attrs="{'invisible': [('status_movement','!=', 'insurance_release')]}"
                            name="action_reject_move"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <label for="name" string="Nombre"/>
                        <h1>
                            <field name="name" string="Nombre"/>
                        </h1>
                    </div>
                    <group col="3">
                        <group string="Datos informativos">
                            <field name="contract_id" readonly="1"/>
                            <field name="contract_num"
                                   attrs="{'invisible': [('type_id','!=',%(policy_movement)d)], 'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="type_id" options="{'no_create': True}"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="sequence" string="Secuencia"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="business_id" options="{'no_create': True}"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="partner_id" readonly="1"/>
                            <field name="pricelist_id" invisible="1"/>
                            <field name="state" invisible="1"/>
                            <field name="tax_country_id" invisible="1"/>
                            <field name="company_id" invisible="1"/>
                            <field name="movement_branch_id" invisible="1"/>
                            <field name="branch_id" invisible="1"/>
                        </group>
                        <group string="Montos de la movimiento">
                            <field name="amount_fee"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="amount_tax_super_cias"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="amount_tax_insurance_peasant"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="amount_tax_emission_rights"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="amount_fee_subtotal"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="amount_tax_iva"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="amount_other_charges"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="amount_due"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="commission_percentage" widget="percentage"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="amount_total_commission" readonly="1" force_save="1"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                        </group>
                        <group string="Fecha de vigencia">
                            <field name="date_start"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="date_end"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))], 'invisible': [('type_id','=',%(broker_do.transportation_application_movement)d)]}"/>
                            <field name="day_number" force_save="1"
                                   attrs="{'invisible': [('day_number','=',False)], 'readonly': True}"/>
                            <separator string="Esquema de facturación"/>
                            <field name="invoice_number"/>
                            <field name="number_period" string="Número de periodos"
                                   attrs="{'invisible': ['|',('payment_period','=','annually'),
                                   ('type_id','in',(%(broker_do.transportation_application_movement)d,%(broker_do.cancel_movement)d,
                                   %(broker_do.exclusion_movement)d))],
                                   'readonly': [('status_movement','in',('approved','rejected'))], 'required': [('payment_period','!=','annually')]}"/>
                            <field name="payment_period" widget="radio" options="{'horizontal': true}"
                                   required="1"
                                   attrs="{'invisible': [('status_movement','in',('approved','rejected'))]}"/>
                            <field name="taxes_calculation"
                                   attrs="{'invisible': [('status_movement','in',('approved','rejected'))]}"/>
                            <field name="date_invoice"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="date_next_payment"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}"/>
                            <field name="warning_flag" invisible="1"/>

                        </group>
                    </group>
                    <div class="alert alert-warning" style="width: 100%" role="alert"
                         attrs="{'invisible': [('warning_flag', '=', False)]}">
                        Se ha cambiado las cuotas del movimiento, genere las comisiones presionando el
                        botón "Generar comisiones".
                    </div>
                    <button type="object" name="action_calculate_fee" string="Generar cuotas de cartera"
                            class="oe_highlight oe_stat_button size_buttons"/>
                    <button type="object" name="action_generate_commission" string="Generar comisiones"
                            class="oe_highlight oe_stat_button size_buttons" groups="account.group_account_invoice"/>
                    <button type="object" name="action_set_invoice_number" string="Establecer num. factura"
                            class="oe_highlight oe_stat_button size_buttons" icon="fa-file-text"
                            confirm="Esta acción establece el número de factura en todas las cuotas, ¿está seguro/a que desea continuar?"/>
                    <button type="object" name="action_recalculate_fee" string="Recalcular cuotas de cartera"
                            class="oe_highlight oe_stat_button size_buttons" icon="fa-file-text"/>
                    <notebook>
                        <page string="Cuotas">
                            <field name="fee_line_ids" force_save="1"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}">
                                <tree string="Cuotas" editable="bottom">
                                    <field name="sequence" readonly="1"/>
                                    <field name="period_id" optional="hide"/>
                                    <field name="period_date_from" optional="hide"/>
                                    <field name="period_date_to" optional="hide"/>
                                    <field name="partner_contract_id"/>
                                    <field name="provisional_payment_date"/>
                                    <field name="invoice_number"/>
                                    <field name="amount_insurance_fee" optional="hide"/>
                                    <field name="amount_insurance_due"/>
                                    <field name="status_fee" readonly="1"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Comisiones">
                            <field name="order_line"
                                   attrs="{'readonly': [('status_movement','not in',('draft','insurance_release'))]}">
                                <tree string="Comisiones">
                                    <field name="sequence"/>
                                    <field name="fee_id" invisible="1"/>
                                    <field name="period_id" optional="hide"/>
                                    <field
                                            name="product_id"
                                            attrs="{
                                        'readonly': [('product_updatable', '=', False)],
                                        'required': [('display_type', '=', False)],
                                    }"
                                            force_save="1"
                                            context="{
                                        'partner_id': parent.partner_id,
                                        'quantity': product_uom_qty,
                                        'pricelist': parent.pricelist_id,
                                        'uom':product_uom,
                                        'company_id': parent.company_id,
                                        'default_lst_price': price_unit,
                                        'default_description_sale': name
                                    }"
                                            options="{
                                        'no_open': True,
                                    }"
                                            domain="[('sale_ok', '=', True), '|', ('company_id', '=', False), ('company_id', '=', parent.company_id)]"
                                            widget="sol_product_many2one"
                                    />
                                    <field name="display_type" invisible="1"/>
                                    <field name="product_uom_category_id" invisible="1"/>
                                    <field name="product_type" invisible="1"/>
                                    <field name="product_updatable" invisible="1"/>
                                    <field name="product_template_id"
                                           string="Product"
                                           invisible="1"
                                           attrs="{
                                    'readonly': [('product_updatable', '=', False)],
                                    'required': [('display_type', '=', False)],
                                    }"
                                           context="{
                                    'partner_id': parent.partner_id,
                                    'quantity': product_uom_qty,
                                    'pricelist': parent.pricelist_id,
                                    'uom':product_uom,
                                    'company_id': parent.company_id,
                                    'default_list_price': price_unit,
                                    'default_description_sale': name
                                    }"
                                           options="{
                                    'no_open': True,
                                    }"
                                           domain="[('sale_ok', '=', True), '|', ('company_id', '=', False), ('company_id', '=', parent.company_id)]"
                                           widget="sol_product_many2one"/>
                                    <field name="name" widget="section_and_note_text" optional="show"/>
                                    <field name="percentage_fee" invisible="0" widget="percentage"/>
                                    <field name="amount_fee" invisible="0"/>
                                    <field name="percentage_commission" invisible="0" widget="percentage"/>
                                    <field name="analytic_distribution" widget="analytic_distribution"
                                           optional="hide"
                                           groups="analytic.group_analytic_accounting"
                                           options="{'product_field': 'product_id', 'business_domain': 'sale_order'}"/>
                                    <field
                                            name="product_uom_qty"
                                            invisible="1"
                                            decoration-info="(not display_type and invoice_status == 'to invoice')"
                                            decoration-bf="(not display_type and invoice_status == 'to invoice')"
                                            context="{
                                        'partner_id': parent.partner_id,
                                        'quantity': product_uom_qty,
                                        'pricelist': parent.pricelist_id,
                                        'uom': product_uom,
                                        'company_id': parent.company_id
                                    }"
                                    />
                                    <field name="qty_delivered"
                                           invisible="1"
                                           decoration-info="(not display_type and invoice_status == 'to invoice')"
                                           decoration-bf="(not display_type and invoice_status == 'to invoice')"
                                           string="Delivered"
                                           attrs="{
                                        'column_invisible': [('parent.state', 'not in', ['sale', 'done'])],
                                        'readonly': [('qty_delivered_method', '!=', 'manual')]
                                    }"
                                           optional="show"
                                    />
                                    <field name="qty_delivered_method" invisible="1"/>
                                    <field
                                            name="qty_invoiced"
                                            string="Invoiced"
                                            invisible="1"
                                    />
                                    <field name="qty_to_invoice" invisible="1"/>
                                    <field name="product_uom_readonly" invisible="1"/>
                                    <field name="product_uom" invisible="1" groups="!uom.group_uom"/>
                                    <field
                                            name="product_uom"
                                            force_save="1"
                                            string="UoM"
                                            attrs="{
                                        'readonly': [('product_uom_readonly', '=', True)],
                                        'required': [('display_type', '=', False)],
                                    }"
                                            context="{'company_id': parent.company_id}"
                                            groups="uom.group_uom"
                                            options='{"no_open": True}'
                                            optional="show"
                                    />
                                    <field
                                            name="customer_lead"
                                            invisible="1"
                                            optional="hide"
                                            attrs="{'readonly': [('parent.state', 'not in', ['draft', 'sent', 'sale'])]}"
                                    />
                                    <field name="product_packaging_qty"
                                           invisible="1"
                                           attrs="{'invisible': ['|', ('product_id', '=', False), ('product_packaging_id', '=', False)]}"
                                           groups="product.group_stock_packaging" optional="show"/>
                                    <field name="product_packaging_id"
                                           attrs="{'invisible': [('product_id', '=', False)]}"
                                           invisible="1"
                                           context="{'default_product_id': product_id, 'tree_view_ref':'product.product_packaging_tree_view', 'form_view_ref':'product.product_packaging_form_view'}"
                                           groups="product.group_stock_packaging" optional="show"/>
                                    <field
                                            name="price_unit"
                                            attrs="{'readonly': [('qty_invoiced', '&gt;', 0)]}"
                                    />
                                    <field
                                            name="tax_id"
                                            widget="many2many_tags"
                                            options="{'no_create': True}"
                                            domain="[('type_tax_use','=','sale'),('company_id','=',parent.company_id), ('country_id', '=', parent.tax_country_id)]"
                                            context="{'active_test': True}"
                                            attrs="{'readonly': [('qty_invoiced', '&gt;', 0)]}"
                                            optional="show"
                                    />
                                    <field name="is_downpayment" invisible="1"/>
                                    <field name="price_subtotal" widget="monetary"
                                           groups="account.group_show_line_subtotals_tax_excluded"
                                           attrs="{'invisible': [('is_downpayment', '=', True)]}"/>
                                    <field name="price_total" widget="monetary"
                                           groups="account.group_show_line_subtotals_tax_included"
                                           attrs="{'invisible': [('is_downpayment', '=', True)]}"/>
                                    <field name="state" invisible="1"/>
                                    <field name="invoice_status" invisible="1"/>
                                    <field name="currency_id" invisible="1"/>
                                    <field name="price_tax" invisible="1"/>
                                    <field name="company_id" invisible="1"/>
                                    <field name="status_commission"/>
                                </tree>
                            </field>
                        </page>
                        <page name="actors" string="Actores">
                            <field name="stakeholder_ids">
                                <tree string="Actores" editable="bottom">
                                    <field name="role"/>
                                    <field name="partner_id"/>
                                </tree>
                            </field>
                        </page>
                        <page name="Objetos Asegurados">
                            <div class="oe_inline">
                                <button name="import_object_data" type="object" string="Importar Objetos"
                                        class="oe_highlight float-end" icon="fa-upload"/>
                                <button name="export_object_data" type="object" string="Descargar Formato"
                                        class="oe_highlight float-end" icon="fa-download"/>
                            </div>
                            <field name="object_line_ids" context="{
                            'default_movement_branch_id': movement_branch_id,
                             'default_branch_id': branch_id,
                             }">
                                <tree>
                                    <field name="branch_id" invisible="1"/>
                                    <field name="movement_branch_id" invisible="1"/>
                                    <field name="movement_id" invisible="1"/>
                                    <field name="name"/>
                                    <field name="type"/>
                                    <field name="amount_insured"/>
                                    <field name="agreement_id"/>
                                </tree>
                            </field>
                        </page>
                        <page name="Documentos" attrs="{'invisible':[('movement_branch_id','=',False)]}">
                            <field name="document_line_ids">
                                <tree>
                                    <field name="name"/>
                                    <field name="upload" widget="boolean_toggle"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Deducible">
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread" options="{'post_refresh': 'recipients'}"/>
                </div>
            </form>
        </field>
    </record>

    <record id="sale_order_tree" model="ir.ui.view">
        <field name="name">sale.order.tree</field>
        <field name="model">sale.order</field>
        <field name="arch" type="xml">
            <tree string="Movimientos">
                <field name="type_id"/>
                <field name="business_id"/>
                <field name="payment_period"/>
                <field name="amount_fee"/>
                <field name="amount_due"/>
                <field name="commission_percentage" widget="percentage"/>
                <field name="amount_total_commission"/>
                <field name="status_movement"/>
            </tree>
        </field>
    </record>

    <record id="sale_order_tree_full_fields" model="ir.ui.view">
        <field name="name">sale.order.tree.full.fields</field>
        <field name="model">sale.order</field>
        <field name="arch" type="xml">
            <tree string="Movimientos">
                <field name="sequence"/>
                <field name="type_id"/>
                <field name="payment_period"/>
                <field name="amount_fee"/>
                <field name="amount_tax_super_cias"/>
                <field name="amount_tax_insurance_peasant"/>
                <field name="amount_tax_emission_rights"/>
                <field name="amount_fee_subtotal"/>
                <field name="amount_tax_iva"/>
                <field name="amount_due"/>
                <field name="commission_percentage"/>
                <field name="amount_total_commission"/>
                <field name="status_movement"/>
            </tree>
        </field>
    </record>

    <record id="sale_order_search" model="ir.ui.view">
        <field name="name">sale.order.search</field>
        <field name="model">sale.order</field>
        <field name="arch" type="xml">
            <search string="Búsqueda de contratos">
                <filter string="Borrador" name="draft" domain="[('status_movement', '=', 'draft')]"/>
                <filter string="Remitido aseguradora" name="valid"
                        domain="[('status_movement','=','insurance_release')]"/>
                <separator/>
                <field name="partner_id"/>
                <field name="insurer_id"/>
                <field name="contract_id"/>
                <field name="date_start"/>
                <field name="date_end"/>
                <group expand="0" string="Group By">
                    <filter string="Estado" name="state" domain="[]" context="{'group_by':'status_movement'}"/>
                    <filter string="Tipo de contrato" name="state" domain="[]" context="{'group_by':'type_id'}"/>
                    <filter string="Aseguradora" name="insurer_id" domain="[]" context="{'group_by':'insurer_id'}"/>
                    <filter string="Cliente" name="client_id" domain="[]" context="{'group_by':'partner_id'}"/>
                    <filter string="Contrato" name="contract_id" domain="[]" context="{'group_by':'contract_id'}"/>
                    <filter string="Incio de vigencia" name="date_start" domain="[]"
                            context="{'group_by': 'date_start'}"/>
                    <filter string="Fin de vigencia" name="date_end" domain="[]" context="{'group_by': 'date_end'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="sale_order_action" model="ir.actions.act_window">
        <field name="name">Movimientos</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="sale_order_tree_full_fields"/>
        <field name="search_view_id" ref="sale_order_search"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Ingrese un Nuevo movimiento
            </p>
            <p>
                Use este menu para crear nuevos movimientos
            </p>
        </field>
    </record>

    <record id="sale_order_type_form" model="ir.ui.view">
        <field name="name">sale.order.type.form</field>
        <field name="model">sale.order.type</field>
        <field name="arch" type="xml">
            <form string="Tipos de movimiento">
                <sheet>
                    <group>
                        <group string="Configuración">
                            <field name="name"/>
                            <field name="code"/>
                            <field name="operation"/>
                            <field name="view_id"/>
                        </group>
                        <group/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="broker_movement_tree" model="ir.ui.view">
        <field name="name">sale.order.tree</field>
        <field name="model">sale.order.type</field>
        <field name="arch" type="xml">
            <tree string="Movimientos" editable="bottom">
                <field name="name"/>
                <field name="code"/>
                <field name="operation"/>
            </tree>
        </field>
    </record>

    <record id="sale_order_type_action" model="ir.actions.act_window">
        <field name="name">Tipos de movimientos</field>
        <field name="res_model">sale.order.type</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Ingrese un nuevo tipo de movimiento
            </p>
        </field>
    </record>

    <!--    Objeto Asegurado-->
    <record id="broker_movement_object_form" model="ir.ui.view">
        <field name="name">broker.movement.object.form</field>
        <field name="model">broker.movement.object</field>
        <field name="arch" type="xml">
            <form string="Objetos Asegurados">
                <header>
                    <button class="oe_highlight oe_stat_button" type="object" string="Pedir Cotización"
                            name="send_email_request_quotation"/>
                    <button class="oe_highlight oe_stat_button" type="object" string="Generar Comparativa"
                            name="generate_comparison" icon="fa-handshake-o"/>
                </header>
                <sheet>
                    <div class="oe_title" name="name">
                        <label for="name" string="Nombre"/>
                        <h1>
                            <field name="name" string="Nombre" required="1" placeholder="Ingrese el nombre"
                                   attrs="{'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}"/>
                        </h1>
                    </div>
                    <group name="object_group">
                        <group>
                            <field name="type_id" invisible="1"/>
                            <field name="movement_id" invisible="1"/>
                            <field name="contract_id" invisible="1"/>
                            <field name="type"
                                   attrs="{'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}"/>
                        </group>
                        <group>
                            <field name="movement_branch_id" invisible="1"/>
                            <field name="coverage_template_id" invisible="1"/>
                        </group>
                    </group>
                    <group>
                        <group>
                            <field name="amount_insured" required="1"
                                   attrs="{'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}"/>
                        </group>
                        <group/>
                    </group>
                    <group>
                        <group>
                            <field name="agreement_id"
                                   attrs="{'invisible': [('agreement_id','=',False)], 'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}"/>
                        </group>
                        <group/>
                    </group>
                    <div class="oe_inline" name="buttons_export">
                        <button name="import_object_data" type="object" string="Importar Objetos"
                                class="oe_highlight float-end" icon="fa-upload"
                                attrs="{'invisible': ['|', ('type','!=','blanket'), ('type_id','=',%(broker_do.exclusion_movement)d)]}"/>
                        <button name="export_object_data" type="object" string="Descargar Formato"
                                class="oe_highlight float-end" icon="fa-download"
                                attrs="{'invisible': ['|', ('type','!=','blanket'), ('type_id','=',%(broker_do.exclusion_movement)d)]}"/>
                    </div>
                    <notebook>
                        <page string="Información Objeto Asegurado" attrs="{'invisible': [('type','=','blanket')]}">
                            <button name="config_field" type="object" string="Añadir Nuevo" class="btn-primary"
                                    attrs="{'invisible': [('type_id','=',%(broker_do.exclusion_movement)d)]}"/>
                            <field name="data_line_ids"
                                   attrs="{'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}">
                                <tree editable="bottom" multi_edit="0" sample="1" create="0">
                                    <field name="name"
                                           attrs="{'readonly': [('parent.type_id','not in',(%(broker_do.policy_movement)d,%(broker_do.transportation_application_movement)d,%(broker_do.inclusion_movement)d,%(broker_do.exclusion_movement)d))]}"/>
                                    <field name="value" widget="widget_type"
                                           attrs="{'readonly': [('parent.type_id','not in',(%(broker_do.policy_movement)d,%(broker_do.transportation_application_movement)d,%(broker_do.inclusion_movement)d,%(broker_do.exclusion_movement)d))]}"/>
                                    <field name="value_change"
                                           attrs="{'column_invisible': [('parent.type_id','in',(%(broker_do.policy_movement)d,%(broker_do.transportation_application_movement)d,%(broker_do.inclusion_movement)d,%(broker_do.exclusion_movement)d))]}"/>
                                    <field name="final_value" readonly="1" force_save="1"
                                           attrs="{'column_invisible': [('parent.type_id','in',(%(broker_do.policy_movement)d,%(broker_do.transportation_application_movement)d,%(broker_do.inclusion_movement)d,%(broker_do.exclusion_movement)d))]}"/>
                                    <field name="type" optional="hide"/>
                                    <field name="value_field" optional="hide"/>
                                    <field name="add_value" optional="hide" widget="boolean_toggle"/>
                                    <button name="config_field" type="object" icon="fa-edit" title="Editar"
                                            attrs="{'invisible': [('parent.type_id','=',%(broker_do.exclusion_movement)d)]}"
                                            class="float-end btn-secondary"/>
                                </tree>
                            </field>
                        </page>
                        <page name="page_blanket" string="Información Blanket"
                              attrs="{'invisible': [('type','!=','blanket')]}">
                            <group>
                                <group>
                                    <field name="amount"
                                           attrs="{'required': [('type','=','blanket')], 'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}"/>
                                </group>
                                <group>
                                    <field name="comment"
                                           attrs="{'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}"/>
                                </group>
                            </group>
                            <group name="group_info">
                            </group>
                        </page>
                        <page string="Información adicional" name="page_info_additional"
                              attrs="{'invisible': [('type','=','blanket')]}">
                            <field name="info_line_ids"
                                   attrs="{'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}">
                                <tree editable="bottom">
                                    <field name="name"/>
                                    <field name="comment"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Acuerdos" name="page_agreements"
                              attrs="{'invisible': [('type','=','blanket')]}">
                            <field name="agreements_line_ids" readonly="1" style="pointer-events: none;"
                                   attrs="{'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}">
                                <tree>
                                    <field name="agreement_id" options='{"no_open": True}'/>
                                    <field name="state" options='{"no_open": True}'/>
                                </tree>
                            </field>
                        </page>
                        <page string="Objetos Asegurados Asociados" name="page_objects"
                              attrs="{'invisible': [('type','!=','blanket')]}">
                            <field name="child_line_ids" readonly="1">
                                <tree>
                                    <field name="name"/>
                                    <field name="type"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Deducibles" name="page_deductible"
                              attrs="{'invisible': [('type','=','blanket')]}">
                            <field name="deductible_ids"
                                   attrs="{'readonly': [('type_id','=',%(broker_do.exclusion_movement)d)]}">
                                <tree editable="bottom">
                                    <field name="template_id"/>
                                    <field name="name"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <xpath expr="//button[hasclass('o_form_button_save_new')]" position="replace">
                </xpath>
            </form>
        </field>
    </record>

    <record id="broker_movement_object_data_form" model="ir.ui.view">
        <field name="name">broker.movement.object.data.form</field>
        <field name="model">broker.movement.object.data</field>
        <field name="arch" type="xml">
            <form>
                <div class="oe_title">
                    <h1>
                        <h1>
                            <label for="name"/>
                        </h1>
                        <field name="name" force_save="1"/>
                    </h1>
                </div>
                <group>
                    <group>
                        <field name="value" widget="widget_type"/>
                    </group>
                    <group>
                        <field name="type"/>
                    </group>
                </group>
                <group>
                    <group>
                        <field name="add_value" widget="boolean_toggle"/>
                    </group>
                    <group>
                        <field name="object_id" invisible="1"/>
                    </group>
                </group>
                <group>
                    <group>
                        <field name="value_field"
                               attrs="{'invisible':[('type','!=','selection')]}"/>
                    </group>
                </group>
            </form>
        </field>
    </record>

    <record id="broker_movement_object_tree" model="ir.ui.view">
        <field name="name">broker.movement.object.tree</field>
        <field name="model">broker.movement.object</field>
        <field name="arch" type="xml">
            <tree string="Objetos Asegurados">
                <field name="name"/>
                <field name="type_id"/>
            </tree>
        </field>
    </record>

    <record id="broker_movement_object_action" model="ir.actions.act_window">
        <field name="name">Objetos Asegurados</field>
        <field name="res_model">broker.movement.object</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Ingrese un nuevo objeto asegurado
            </p>
        </field>
    </record>


    <!--    Documentos-->
    <record id="sale_order_document_tree" model="ir.ui.view">
        <field name="name">sale.order.document.tree</field>
        <field name="model">sale.order.document</field>
        <field name="arch" type="xml">
            <tree string="Documentos" create="False" editable="bottom">
                <field name="order_id" invisible="1"/>
                <field name="contract_id" invisible="1"/>
                <field name="name"/>
                <field name="upload" widget="boolean_toggle"/>
            </tree>
        </field>
    </record>

    <record id="sale_order_document_search" model="ir.ui.view">
        <field name="name">sale.order.document.search</field>
        <field name="model">sale.order.document</field>
        <field name="arch" type="xml">
            <search>
                <group expand="0" string="Group By">
                    <filter string="Contrato" name="group_by_contract" domain="[]"
                            context="{'group_by':'contract_id'}"/>
                    <filter string="Movimiento" name="group_by_movement" domain="[]" context="{'group_by':'order_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="sale_order_document_action" model="ir.actions.act_window">
        <field name="name">Documentos Pendientes</field>
        <field name="res_model">sale.order.document</field>
        <field name="view_mode">tree</field>
        <field name="domain">[('upload','=',False),('order_id.status_movement','in',('insurance_release','approved'))]
        </field>
        <field name="context">{'search_default_group_by_contract': 1, 'search_default_group_by_movement': 1}</field>
        <field name="search_view_id" ref="broker_do.sale_order_document_search"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Ingrese un nuevo documento
            </p>
        </field>
    </record>

    <!--  Reconfiguración del menu de ventas  -->

    <record id="sale.action_quotations_with_onboarding" model="ir.actions.act_window">
        <field name="view_id" ref="sale_order_tree"/>
        <field name="context">{}</field>
    </record>

    <record id="sale.action_orders_to_invoice" model="ir.actions.act_window">
        <field name="view_id" ref="sale_order_tree"/>
    </record>

    <record id="sale.sale_order_action_view_order_tree" model="ir.actions.act_window.view">
        <field name="view_id" ref="sale_order_tree"/>
    </record>

    <record id="sale.sale_order_action_view_order_form" model="ir.actions.act_window.view">
        <field name="view_id" ref="sale_order_form"/>
    </record>

</odoo>
